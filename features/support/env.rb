# IMPORTANT: This file is generated by cucumber-rails - edit at your own peril.
# It is recommended to regenerate this file in the future when you upgrade to a
# newer version of cucumber-rails. Consider adding your own code to a new file
# instead of editing this one. Cucumber will automatically load all features/**/*.rb
# files.

require 'cucumber/rails'

require 'email_spec'
require 'email_spec/cucumber'

#require 'cucumber/rspec/doubles'
#require 'capybara-screenshot/cucumber'

# Capybara defaults to XPath selectors rather than Webrat's default of CSS3. In
# order to ease the transition to Capybara we set the default here. If you'd
# prefer to use XPath just remove this line and adjust any selectors in your
# steps to use the XPath syntax.

require "rack_session_access/capybara"

ENV["RAILS_ENV"] ||= 'test'
Capybara.default_selector = :css
ActionController::Base.allow_rescue = false
Cucumber::Rails::Database.javascript_strategy = :truncation
Capybara.default_wait_time = 5

require 'capybara/poltergeist'

polter_options = {
  :phantomjs_options => ['--load-images=no'],
  js_errors: true,
  inspector: true,
  debug: false
}

Capybara.register_driver :poltergeist do |app|
  Capybara::Poltergeist::Driver.new(app, polter_options)
end

Capybara.javascript_driver = :poltergeist
#Capybara.javascript_driver = :selenium
Capybara.default_driver = :rack_test

ENV['AWS_ACCESS_KEY_ID']="notarealaccesskeyid"
ENV['AWS_SECRET_ACCESS_KEY']="notarealsecretaccesskey"
ENV['AWS_ATTACHMENTS_BUCKET']="notarealbucker"
ENV['DEVISE_SECRET'] = 'testvalueaskjdhakjdhaksjhdkajhdkjahdkjashkjdhakjdh'

Before do |scenario|
  stub_request(:head, /gravatar.com/).with(:headers => {'Accept'=>'*/*', 'User-Agent'=>'Ruby'}).to_return(:status => 200, :body => "", :headers => {})
end

