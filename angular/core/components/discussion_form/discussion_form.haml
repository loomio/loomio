%form.discussion-form{name: "discussionForm", ng-paste: "handlePaste($event)", ng_submit: "submit()", ng-disabled: "isDisabled"}
  .lmo-disabled-form{ng-show: "isDisabled"}
  %input{type: "hidden", ng-model: "discussion.usesMarkdown"}
  .modal-header
    %modal_header_cancel_button
    %h1.lmo-h1.modal-title{translate: "discussion_form.new_discussion_title", ng-show: "discussion.isNew()"}
    %h1.lmo-h1.modal-title{translate: "discussion_form.edit_discussion_title", ng-hide: "discussion.isNew()"}

  .modal-body
    %form_errors{record: "discussion"}

    .discussion-form__helptext{translate: "discussion_form.discussion_helptext", ng-show: "discussion.isNew()"}

    %md-input-container.lmo-input-container{ng-show: "showGroupSelect"}
      %label{for: "discussion-group-field", translate: "discussion_form.group_label"}
      %md-select.discussion-form__group-select#discussion-group-field{ng-model: "discussion.groupId", ng-required: "true", ng-change: "restoreRemoteDraft(); updatePrivacy()"}
        %md-option{value: "", translate: "discussion_form.group_placeholder"}
        %md-option{ng-repeat: "group in availableGroups() track by group.id | orderBy: 'fullName'", ng-value: "group.id"}
          {{group.fullName}}

    .discussion-group-selected{ng-if: "discussion.groupId"}
      %md-input-container.lmo-input-container
        %label{for: "discussion-title", translate: "discussion_form.title_label"}
        %input.discussion-form__title-input.lmo-primary-form-input#discussion-title{placeholder: "{{ 'discussion_form.title_placeholder' | translate }}", ng-model: "discussion.title", ng-required: "true", maxlength: "255"}
        %validation_errors{subject: "discussion", field: "title"}

      .discussion-form__context-container.lmo-flex-container.lmo-relative
        %md-input-container.lmo-input-container
          %label{for: "discussion-context", translate: "discussion_form.context_label"}
          %textarea.lmo-textarea.discussion-form__description-input.lmo-primary-form-input#discussion-context{msd-elastic: "true", ng-model: "discussion.description", placeholder: "{{ 'discussion_form.context_placeholder' | translate }}", mentio: "true", mentio-trigger-char: "'@'", mentio-items: "mentionables", mentio-template-url: "generated/components/thread_page/comment_form/mentio_menu.html", mentio-search: "fetchByNameFragment(term)", mentio-id: "discussion-field", ng-model-options: "{debounce: 150}"}
        %emoji_picker.lmo-material-emoji-picker{target-selector: "descriptionSelector"}

      .discussion-form__attachments
        %attachment_form.discussion-form__attachment-form{model: "discussion", ng-if: "discussion.groupId", show-label: "true"}
        %validation_errors.discussion-form__attachment-errors{subject: "discussion", field: "file"}
        %label.lmo-form-labelled-input
          %attachment_preview{attachment: "attachment", mode: "thumb", ng-repeat: "attachment in discussion.newAttachments() | orderBy: 'id' track by attachment.id"}
        .clearfix

      %md-input-container{ng-show: "showPrivacyForm()"}
        %md-radio-group{ng-model: "discussion.private"}
          %md-radio-button.md-primary.discussion-form__public{value: "false", aria-label: "common.privacy.public"}
            %span
              %i.fa.fa-globe>
              %strong{translate: "common.privacy.public" }
              %span.lmo-separator
              %span{translate: "discussion_form.privacy_public"}
          %md-radio-button.discussion-form__private{value: "true", aria-label: "common.privacy.private"}
            %span
              %i.fa.fa-lock>
              %strong{translate: "common.privacy.private"}
              %span.lmo-separator
              %span{ng-bind-html: "privacyPrivateDescription()"}

      .privacy-notice{ng-show: "!showPrivacyForm()"}
        %label.lmo-form-labelled-input{ng_hide: "discussion.private"}
          %span
            %i.fa.fa-globe>
            %strong{translate: "common.privacy.public"}
            %span.lmo-separator
            %span{translate: "discussion_form.privacy_public"}

        %label.lmo-form-labelled-input{ng-show: "discussion.private"}
          %span
            %i.fa.fa-lock>
            %strong{translate: "common.privacy.private"}
            %span.lmo-separator
            %span{ng-bind-html: "privacyPrivateDescription()"}

  .lmo-modal-footer
    %md-button.md-primary.md-raised.pull-right.discussion-form__submit{type: "submit", ng-disabled: "submitIsDisabled || !discussion.groupId", translate: "discussion_form.new_discussion_submit", ng-show: "discussion.isNew()", aria-label: "discussion_form.new_discussion_submit"}
    %a.discussion-form__formatting-help{lmo-href: "/markdown", tabindex: 0, target: "_blank", title: "{{ 'common.formatting_help.title' | translate }}"}
      %span{translate: "common.formatting_help.label"}
    %md-button.md-primary.md-raised.pull-right.discussion-form__update{type: "submit", ng-disabled: "submitIsDisabled", translate: "discussion_form.edit_discussion_submit", ng-hide: "discussion.isNew()", aria-label: "discussion_form.edit_discussion_submit"}
    %md-button.md-raised.pull-left.discussion-form__cancel{type: "button", ng-click: "$close()", translate: "common.action.cancel", aria-label: "common.action.cancel"}
